# Robotics HUB Challenge ルールブック (第4回大会バージョン)

## はじめに

### 概要

本ドキュメントでは，**第4回 Robotics HUB Challenge で行う競技 burger warの競技ルールおよび，大会ルールについて説明する．**



## 目次

- burger war ルール
  - 概要
  - フィールド
  - ターゲット
  - 勝敗の決定方法
  - リトライ
  - 開始シーケンス
  - ロボット機体情報
  - その他
- 大会ルール
  - 概要
  - シミュレータ予選ルール
  - 本戦ルール



## burger war ルール

### 概要

「burger war」は，ロボットを自律移動させ，１対１で撃ち合うゲームである．

主砲の代わりに，正面のカメラでターゲット(ARマーカー)を読み取って対戦を行う.

ターゲットから読み取ったIDを審判サーバーに提出すると，その的を撃ち落としたという扱いになる．

ターゲットはフィールドと機体に取り付けられています．フィールドのターゲットは固定されているので容易に撃てる反面ポイントは少なく，機体のターゲットは撃つのが難しかわりに高得点となる．
相手を狙うのか，フィールドのターゲットを多く狙うのかどのような戦略で行動するかが重要になる．

ロボットは完全自律制御とし，スタート後は手動操作を禁止する．



### フィールド
フィールド及びターゲットの寸法などの詳細は本リポジトリの[burger_war_field](doc/burger_war_field.md)を参照．

- **2.4m**四方の壁で囲われたフィールド内で競技を行う．
- 競技フィールド内には，障害物を設置する．
- **障害物**は，常に同じ位置に初期設置する．
- **障害物**は，動かないように床面に固定して設置している．
- **障害物**が動いた場合も試合は続行する．
- **フィールドの壁**は，ロボットで押しても動かないように固定する．
- **床面**は会場の床の上にフロアシートを設置する．
- **落とし穴**は，中央が凹んだ黄色い円盤状の障害物で，床面の上に動かないように固定して設置している．落とし穴は，LiDARでは検出できない．落とし穴の上を走行することは可能であるが、後輪キャスターが落とし穴の凹んだ部分に入ると，脱出に時間がかかる場合がある．落とし穴の場所は，予選では公表されているが，本戦では変更される場合がある．




### ターゲット
ターゲットは**直径80mm**の円形，中心にARマーカーを印刷している．

機体に取り付けるターゲットと，フィールどに設置されたターゲットがあり，機体のターゲットは緑，フィールドのターゲットは青色をしている．

**機体のターゲット**は，上の画像のように左右１枚づつ，背後１枚の計**3枚**．**フィールドのターゲット**は点対称に**12枚**設置する．






### 勝敗の決定方法
ターゲットから読み取ったIDを審判サーバーに提出すると，そのターゲットを撃ち抜いたと扱う．
ターゲットを撃ち抜くと，ポイントを獲得できる．

**フィールドターゲットは最後に獲得したチームのポイントとなる．** １度獲得しても相手に取り返された場合，相手のポイントとなる．制限時間内ならば，何度でも取り返す事ができる．

**相手とのポイント差が１０ポイント以上になった時点でポイントの多いチームのコールド勝ちとする．**
複数ポイント獲得時に点差が10ポイントを超える場合は、複数得点をすべて加算した状態で試合終了とする。そのため10点コールドルールでも試合スコアが10点差を超える場合がある。
ex) 赤 9点 : 青 0点 の状態で赤が背後のマーカを読み取り5点加点した場合の試合結果は 14 : 0 の14点差となる。10 : 0 の10点差ではない。

**配点**

- 相手背後   ： ５ポイント
- 相手左右   ： ３ポイント
- フィールド ：１ポイント

**制限時間３分間**以内にコールド勝ち，または終了時にポイントが多いチームの勝利，同点の場合は引き分けとする．

制限時間終了時，両チーム同点の場合は，**1分間のサドンデス**に突入する．サドンデスでは先に１点でも得点したチームの勝利とする．

サドンデスでも決着がつかなかった場合は，引き分けとなる。
トーナメントなど勝敗を必ず決する必要がある場合は、チームの代表者によるじゃんけんで勝敗を決める．





### ロボット機体情報
ロボットはturtlebot3 burger を使用する．
ロボットの詳細情報は[burger_spec.pdf](/doc/burger_spec.pdf)を参照ください．

ロボットは運営が準備したものを使用するものとし，改造を禁止する．

**マーカーの読み取り機能は運営が準備したプログラムを使用するものとし改造を禁止する．マーカーの読み取りモジュールに入力する画像を参加者側で加工することを禁止する．**



### その他
機体に著しい負担がかかり故障や事故が予想されるなど，審判が危険と判断した場合は試合を中断し，負けとする場合がある（レフェリーストップ）．

競技者が競技中にコース内に入ることは認めない．また，意図的にロボットのセンサに作用するような行動で，誤動作を誘発させたり，意図的な操作を行うことを禁止する．

審判の判断で悪質なチート行為があったと判断した場合は，警告したうえで再試合または，該当チームを失格とすることができる．



## 大会ルール


### 概要

大会ルールについて説明する．大会は，シミュレータによる予選と実機を使った本戦の２段階に分けて行う．シミュレータ予選の結果によって本戦のリーグ分けを実施する．

シミュレータ予選は運営の用意した３種類のプログラムと対戦し，その結果によって順位を決定する．前回大会とちがい，参加チーム同士の対戦は行わない．



本戦は実機での対戦を行う．本戦はリーグ戦と決勝トーナメントの２段階に分けて行う．
リーグ戦の成績上位チームが決勝トーナメントに進む．決勝トーナメントによって大会の優勝チームを決定する．



### シミュレータ予選ルール

シミュレータ予選は運営の用意した**３種類のプログラム**とシミュレータ上で対戦し，その結果によって順位を決定する．

詳細な順位の決定方法は下記のとおりとする．

順位を決める際に参照するの指標は次の４つ．**勝ち点，コールド勝ち数，得失点，得点**．

- 勝ち点：勝利で３ポイント，負けで０ポイント，引き分けで１ポイント

- コールド勝ち数：コールド勝ちした回数

- 得失点：全試合の 得点 - 失点 の合計

- 得点：全試合の得点の合計

  

それぞれの重要度は次の順とする． 勝ち点 > コールド勝ち数 > 得失点 > 得点．（まず"勝ち点"で順位をつけ同点の場合"コールド勝ち数"，それも同じ場合"得失点" の順で評価する）４つの指標がすべて同点で優劣がつけられない場合は抽選によって優劣を決定する．



### 本戦ルール

#### リーグ戦

リーグ戦の組み合わせはシミュレータ予選の結果に応じて決定する．
各リーグの上位チームが決勝トーナメントに進出する．
リーグ戦の順位はシミュレータ予選と同様に次の４つの指標によって決定する．**勝ち点，コールド勝ち数，得失点，得点**．



#### 決勝トーナメント

リーグ戦の上位チームでトーナメント戦を行う．
トーナメントの組み合わせはリーグ戦の成績に応じて決定する．
